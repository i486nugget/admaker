<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>adMAKER</title>
  <style>
    body {
      background: #111;
      color: white;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      text-align: center;
    }

    #videoPlayer {
      display: none;
      margin: 20px 0;
      max-width: 100%;
    }

    button {
      background: #2196F3;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 18px;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s;
      margin: 20px auto;
    }

    button:hover {
      background: #1976D2;
      transform: scale(1.05);
    }

    .progress {
      width: 100%;
      max-width: 640px;
      background: #333;
      border-radius: 4px;
      margin: 20px 0;
      height: 20px;
      overflow: hidden;
    }

    .progress-bar {
      width: 0%;
      height: 100%;
      background: #2196F3;
      transition: width 0.3s;
    }

    .status {
      margin: 10px 0;
      font-size: 16px;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Internet Advert Maker</h1>
  <p>Click the button to generate a 10-second random advertisement video!</p>
  <div class="progress">
    <div id="progressBar" class="progress-bar"></div>
  </div>
  <div id="status" class="status">Ready to generate</div>
  <button id="generateBtn" onclick="generateVideo()">Generate New Ad</button>
  <video id="videoPlayer" controls></video>
  <button id="saveBtn" style="display:none;" onclick="saveVideo()">Save as MP4</button>
</div>

<script>
  const adjectives = [
    { word: "REVOLUTIONARY", theme: "technology" },
    { word: "SUSPICIOUS", theme: "mystery" },
    { word: "GROUNDBREAKING", theme: "science" },
    { word: "SKETCHY", theme: "urban" },
    { word: "LIFE-CHANGING", theme: "nature" }
  ];

  const prices = [
    "£999.99/month",
    "£199.99/week",
    "£10,000/month",
    "£69,420/year",
    "£0.99/lifetime"
  ];

  const platforms = [
    "bluesky",
    "myspace",
    "x formerly twittah",
    "mastodon",
    "tiktok"
  ];

  const themes = {
    technology: "https://source.unsplash.com/640x480/?technology",
    mystery: "https://source.unsplash.com/640x480/?dark",
    science: "https://source.unsplash.com/640x480/?science",
    urban: "https://source.unsplash.com/640x480/?city",
    nature: "https://source.unsplash.com/640x480/?nature"
  };

  let videoBlob;

  function getRandomFrom(array) {
    return array[Math.floor(Math.random() * array.length)];
  }

  async function generateVideo() {
    const generateBtn = document.getElementById('generateBtn');
    const status = document.getElementById('status');
    const progressBar = document.getElementById('progressBar');
    const videoPlayer = document.getElementById('videoPlayer');
    const saveBtn = document.getElementById('saveBtn');

    generateBtn.style.display = 'none';
    saveBtn.style.display = 'none';
    videoPlayer.style.display = 'none';
    status.textContent = 'Generating video...';
    progressBar.style.width = '0%';

    const fps = 1;
    const duration = 10;
    const frames = [];
    const ctx = document.createElement('canvas').getContext('2d');
    ctx.canvas.width = 640;
    ctx.canvas.height = 480;

    const chunks = [];
    const stream = ctx.canvas.captureStream(fps);
    const recorder = new MediaRecorder(stream, { mimeType: 'video/webm; codecs=vp9' });

    recorder.ondataavailable = e => chunks.push(e.data);
    recorder.onstop = () => {
      videoBlob = new Blob(chunks, { type: 'video/webm' });
      videoPlayer.src = URL.createObjectURL(videoBlob);
      videoPlayer.style.display = 'block';
      saveBtn.style.display = 'block';
      status.textContent = 'Video ready!';
      progressBar.style.width = '100%';
      generateBtn.style.display = 'block';
    };

    recorder.start();

    for (let i = 0; i < duration; i++) {
      const adjective = getRandomFrom(adjectives);
      const price = getRandomFrom(prices);
      const platform = getRandomFrom(platforms);
      const themeUrl = themes[adjective.theme] + `&random=${Math.random()}`;

      const img = new Image();
      img.src = themeUrl;

      await new Promise(resolve => {
        img.onload = () => {
          ctx.drawImage(img, 0, 0, 640, 480);

          ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';
          ctx.fillRect(0, 380, 640, 100);

          ctx.fillStyle = 'white';
          ctx.font = 'bold 28px Arial';
          ctx.textAlign = 'center';

          ctx.fillText(adjective.word, 320, 400);
          ctx.fillText(price, 320, 430);
          ctx.fillText(platform, 320, 460);

          recorder.requestData();
          const progress = ((i + 1) / duration) * 100;
          progressBar.style.width = `${progress}%`;
          resolve();
        };
      });

      await new Promise(resolve => setTimeout(resolve, 1000 / fps));
    }

    recorder.stop();
  }

  function saveVideo() {
    const a = document.createElement('a');
    a.href = URL.createObjectURL(videoBlob);
    a.download = 'adMAKER.mp4';
    a.click();
  }
</script>
</body>
</html>
